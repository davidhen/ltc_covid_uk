<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="David Henderson" />


<title>UK comparison</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.15/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="site_libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LTC COVID</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="care_inspectorate_wrangle.html">Care inspectorate wrangle</a>
    </li>
    <li>
      <a href="ltc_covid_uk_code.html">Figures 1-3</a>
    </li>
    <li>
      <a href="excess_mort_plot.html">Excess mortality plots</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">UK comparison</h1>
<h4 class="author">David Henderson</h4>
<h4 class="date">13/07/2020</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Code for figures and values for Figures 1, 2, and 3.</p>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>R packages and helper functions….</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(curl)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(forcats)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(socviz)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(here)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#Helper function</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="st">`</span><span class="dt">%nin%</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">negate</span>(<span class="st">`</span><span class="dt">%in%</span><span class="st">`</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#Short cut for csv output with html tables</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>my_datatable &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb1-13"><a href="#cb1-13"></a>  DT<span class="op">::</span><span class="kw">datatable</span>(x, <span class="dt">extensions =</span> <span class="st">&quot;Buttons&quot;</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">dom =</span> <span class="st">&quot;Bfrtip&quot;</span>, </span>
<span id="cb1-14"><a href="#cb1-14"></a>                                                          <span class="dt">buttons =</span> <span class="kw">c</span>(<span class="st">&quot;csv&quot;</span>)))</span>
<span id="cb1-15"><a href="#cb1-15"></a>}</span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#Baseline plot settings</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="kw">theme_set</span>(<span class="kw">theme_minimal</span>(<span class="dt">base_family =</span> <span class="st">&quot;Roboto&quot;</span>, <span class="dt">base_size =</span> <span class="dv">20</span>) <span class="op">+</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="st">            </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb1-20"><a href="#cb1-20"></a>                  <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">0</span>)),</span>
<span id="cb1-21"><a href="#cb1-21"></a>                  <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)),</span>
<span id="cb1-22"><a href="#cb1-22"></a>                  <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;#AAAAAA&quot;</span>),</span>
<span id="cb1-23"><a href="#cb1-23"></a>                  <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">3</span>,<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="st">&quot;mm&quot;</span>)))</span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">#global options for scientific numbers and significant digits.          </span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">10</span>,</span>
<span id="cb1-27"><a href="#cb1-27"></a>        <span class="dt">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="figure-1" class="section level1">
<h1>Figure 1</h1>
<p>Figure 1 shows the distribution of care home size across the 4 nations with violin and boxplots.</p>
<div id="load-in-data" class="section level2">
<h2>Load in data</h2>
<p>The data used to create this plot is derived from information from the relevant Care inspectorates in each nation. These files required some pre-processing which can be found in the <code>care_inspectorate_wrangle.Rmd</code> file. The raw data files are in the <code>raw_data</code> folder. The derived, combined, dataset is imaginatively called <code>uk</code> and is found in the <code>derived_data</code> folder as a <code>feather</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#read in wrangled data to global environment</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>uk &lt;-<span class="st"> </span>feather<span class="op">::</span><span class="kw">read_feather</span>(<span class="st">&quot;derived_data/uk.feather&quot;</span>)</span></code></pre></div>
</div>
<div id="plot-all-care-homes" class="section level2">
<h2>Plot all care homes</h2>
<p>Note this plot shows the distribution of all adult care homes in each country, not care homes for older people.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>uk <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">fct_rev</span>(country), <span class="st">`</span><span class="dt">Care homes beds</span><span class="st">`</span>, <span class="dt">colour =</span> country)) <span class="op">+</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="st">  </span><span class="kw">scale_colour_wsj</span>() <span class="op">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>       <span class="dt">y =</span> <span class="st">&quot;Number of care home beds&quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>       <span class="dt">caption =</span> <span class="st">&quot;Outer line indicates distribution</span><span class="ch">\n</span><span class="st">Strong vertical line in box indicates the median</span><span class="ch">\n</span><span class="st">Box limits indicate 25th and 75th percentile</span><span class="ch">\n</span><span class="st">Dots indicate statistical outliers&quot;</span>) -&gt;<span class="st"> </span>fig_<span class="dv">4</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>fig_<span class="dv">4</span></span></code></pre></div>
<p><img src="ltc_covid_uk_code_files/figure-html/unnamed-chunk-3-1.png" width="1152" /></p>
</div>
</div>
<div id="calculate-number-of-care-homes-and-bed-numbers" class="section level1">
<h1>Calculate number of care homes and bed numbers</h1>
<p>Some useful summary figures which contribute to Table 1 in the report</p>
<div id="all-adult-care-homes" class="section level2">
<h2>All Adult Care Homes</h2>
<p>This uses all data in the <code>uk</code> data object</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>uk <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total_n =</span> <span class="kw">n</span>(),</span>
<span id="cb4-4"><a href="#cb4-4"></a>            <span class="dt">total_beds =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">Care homes beds</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total_n =</span> <span class="kw">as.numeric</span>(total_n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="st">  </span><span class="kw">bind_rows</span>(<span class="kw">summarise_all</span>(., <span class="kw">funs</span>(<span class="cf">if</span>(<span class="kw">is.numeric</span>(.)) <span class="kw">sum</span>(.) <span class="cf">else</span> <span class="st">&quot;Total&quot;</span>)))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["total_n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["total_beds"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"England","2":"15481","3":"457428"},{"1":"Scotland","2":"1057","3":"38614"},{"1":"Wales","2":"1056","3":"25555"},{"1":"Northern Ireland","2":"481","3":"16059"},{"1":"Total","2":"18075","3":"537656"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><em>Note 15 care homes in Scotland do not provide <code>total_beds</code> figures.</em></p>
</div>
<div id="care-homes-for-older-people" class="section level2">
<h2>Care Homes for older people</h2>
<p>Care Inspectorate for Wales does not classify care home type by older people so we must remove them from this summary. The code block below shows how we filtered the other nations data to include only care homes for older people. This is subjective and there is no clear documentation or metadata to aid with this. It is also important to note that some care homes may include a mix of older and younger clients.</p>
<p>England: Filter on “Service User Band - Older people” option Scotland: using Subtypes “Older People” and “Respite Care and Short Breaks” Northern Ireland: Categories of care including the letters “I” or “DE” (this reflects how Quality Improvement Authority Northern Ireland subset)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>uk <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">!=</span><span class="st"> &quot;Wales&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">case_when</span>(</span>
<span id="cb5-4"><a href="#cb5-4"></a>    country <span class="op">==</span><span class="st"> &quot;England&quot;</span> <span class="op">~</span><span class="st"> `</span><span class="dt">Service user band - Older People</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Y&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>    country <span class="op">==</span><span class="st"> &quot;Scotland&quot;</span> <span class="op">~</span><span class="st"> </span>Subtype <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Older People&quot;</span>, <span class="st">&quot;Respite Care and Short Breaks&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6"></a>    country <span class="op">==</span><span class="st"> &quot;Northern Ireland&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">str_detect</span>(<span class="st">`</span><span class="dt">Categories of Care</span><span class="st">`</span>, <span class="st">&quot;I&quot;</span>) <span class="op">|</span><span class="st"> </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="st">      </span><span class="kw">str_detect</span>(<span class="st">`</span><span class="dt">Categories of Care</span><span class="st">`</span>, <span class="st">&quot;DE&quot;</span>) </span>
<span id="cb5-8"><a href="#cb5-8"></a>  )) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total_n =</span> <span class="kw">n</span>(),</span>
<span id="cb5-11"><a href="#cb5-11"></a>            <span class="dt">total_beds =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">Care homes beds</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["total_n"],"name":[2],"type":["int"],"align":["right"]},{"label":["total_beds"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"England","2":"10894","3":"411272"},{"1":"Scotland","2":"805","3":"35320"},{"1":"Northern Ireland","2":"392","3":"14464"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><em>Note 10 care homes in Scotland do not provide <code>total_beds</code> figures.</em></p>
</div>
</div>
<div id="figures-2-3-deaths-per-100000" class="section level1">
<h1>Figures 2 &amp; 3 deaths per 100,000</h1>
<div id="data" class="section level2">
<h2>Data</h2>
<p>Data for Figure 2 <em>&amp;</em> 3 is sourced from the ONS Deaths registered in England and Wales available <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/deaths/datasets/weeklyprovisionalfiguresondeathsregisteredinenglandandwales">here</a></p>
<p>To calculate per 100,000 estimates we used population estimates from <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/datasets/populationestimatesforukenglandandwalesscotlandandnorthernireland">here</a> and crudely added them in manually in the code as seen below.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">#Assign url for ONS data and download into a temporary file</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>url &lt;-<span class="st"> &quot;https://www.ons.gov.uk/file?uri=%2fpeoplepopulationandcommunity%2fbirthsdeathsandmarriages%2fdeaths%2fdatasets%2fweeklyprovisionalfiguresondeathsregisteredinenglandandwales%2f2020/publishedweek282020.xlsx&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>temp &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb6-4"><a href="#cb6-4"></a>temp &lt;-<span class="st"> </span><span class="kw">curl_download</span>(<span class="dt">url=</span>url, <span class="dt">destfile=</span>temp, <span class="dt">quiet=</span><span class="ot">FALSE</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#Extract weekly data for each country from &quot;UK&quot; Worksheet and tidy up</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>uk_deaths_data &lt;-</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="st">  </span><span class="kw">read_xlsx</span>(temp, <span class="dt">sheet=</span><span class="st">&quot;UK - Covid-19 - Weekly reg&quot;</span>, </span>
<span id="cb6-10"><a href="#cb6-10"></a>                         <span class="dt">range =</span> <span class="st">&quot;A4:AB12&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Week number</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">country =</span> <span class="st">`</span><span class="dt">...2</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="st">  </span><span class="co">#reshape to long format</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">1</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">26</span><span class="st">`</span>, <span class="dt">names_to =</span> <span class="st">&quot;week_number&quot;</span>, </span>
<span id="cb6-16"><a href="#cb6-16"></a>               <span class="dt">values_to =</span> <span class="st">&quot;covid_deaths&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="st">  </span><span class="co">#coerce week number to integer</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week_number =</span> <span class="kw">as.integer</span>(week_number)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="st">  </span><span class="co">#drop rows before week 11</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="st">  </span><span class="kw">filter</span>(week_number <span class="op">&gt;=</span><span class="st"> </span><span class="dv">11</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="st">  </span><span class="co">#coerce country variable to a factor</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">country =</span> <span class="kw">factor</span>(country, </span>
<span id="cb6-23"><a href="#cb6-23"></a>                          <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;England&quot;</span>, <span class="st">&quot;Scotland&quot;</span>, </span>
<span id="cb6-24"><a href="#cb6-24"></a>                          <span class="st">&quot;Wales&quot;</span>, <span class="st">&quot;Northern Ireland&quot;</span>)),</span>
<span id="cb6-25"><a href="#cb6-25"></a>         <span class="co">#manually add in population size</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>         <span class="dt">pop =</span> <span class="kw">case_when</span>(</span>
<span id="cb6-27"><a href="#cb6-27"></a>           country <span class="op">==</span><span class="st"> &quot;England&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">56286961</span>,</span>
<span id="cb6-28"><a href="#cb6-28"></a>           country <span class="op">==</span><span class="st"> &quot;Wales&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3152879</span>,</span>
<span id="cb6-29"><a href="#cb6-29"></a>           country <span class="op">==</span><span class="st"> &quot;Scotland&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">5463300</span>,</span>
<span id="cb6-30"><a href="#cb6-30"></a>           country <span class="op">==</span><span class="st"> &quot;Northern Ireland&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1893667</span>),</span>
<span id="cb6-31"><a href="#cb6-31"></a>    <span class="co">#Calculate deaths per 100,000</span></span>
<span id="cb6-32"><a href="#cb6-32"></a>    <span class="dt">deaths_100000 =</span> covid_deaths<span class="op">/</span>pop <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>)</span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co">#Print out the result</span></span>
<span id="cb6-34"><a href="#cb6-34"></a>uk_deaths_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="st">  </span><span class="kw">round_df</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="st">  </span><span class="kw">my_datatable</span>(.)</span></code></pre></div>
<div id="htmlwidget-2fefed71d154b785fc0b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2fefed71d154b785fc0b">{"x":{"filter":"none","extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64"],["England","England","England","England","England","England","England","England","England","England","England","England","England","England","England","England","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Wales","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Scotland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland","Northern Ireland"],[11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],[5,100,515,3330,5899,8335,7806,5748,3716,3624,2455,1715,1488,1057,744,574,0,2,21,134,304,409,413,281,211,180,134,105,100,57,39,30,0,11,62,282,609,650,661,527,415,336,230,131,89,69,49,35,0,1,9,55,76,101,128,124,84,74,53,49,20,21,17,12],[56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,56286961,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,3152879,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,5463300,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667,1893667],[0.01,0.18,0.91,5.92,10.48,14.81,13.87,10.21,6.6,6.44,4.36,3.05,2.64,1.88,1.32,1.02,0,0.06,0.67,4.25,9.64,12.97,13.1,8.91,6.69,5.71,4.25,3.33,3.17,1.81,1.24,0.95,0,0.2,1.13,5.16,11.15,11.9,12.1,9.65,7.6,6.15,4.21,2.4,1.63,1.26,0.9,0.64,0,0.05,0.48,2.9,4.01,5.33,6.76,6.55,4.44,3.91,2.8,2.59,1.06,1.11,0.9,0.63]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>week_number<\/th>\n      <th>covid_deaths<\/th>\n      <th>pop<\/th>\n      <th>deaths_100000<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="figure-2-overall-deaths" class="section level2">
<h2>Figure 2 Overall deaths</h2>
<p>Basic plot of the total number of deaths in each week</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>uk_deaths_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">  </span><span class="co">#summarise the uk deaths data table</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span><span class="kw">group_by</span>(week_number) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">tot_deaths =</span> <span class="kw">sum</span>(covid_deaths)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  </span><span class="co">#and pipe into the plot</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(week_number, tot_deaths)) <span class="op">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="kw">wsj_pal</span>()(<span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(),</span>
<span id="cb7-10"><a href="#cb7-10"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10000</span>)) <span class="op">+</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Weekly deaths attributed to COVID-19 in the UK&quot;</span>,</span>
<span id="cb7-12"><a href="#cb7-12"></a>       <span class="dt">x =</span> <span class="st">&quot;Week number&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source:ONS Deaths registered in England and Wales, UK deaths</span><span class="ch">\n</span><span class="st">Code:https://github.com/davidhen/ltc_covid_uk&quot;</span>) -&gt;<span class="st"> </span>fig_<span class="dv">1</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>fig_<span class="dv">1</span></span></code></pre></div>
<p><img src="ltc_covid_uk_code_files/figure-html/unnamed-chunk-8-1.png" width="1152" /></p>
</div>
<div id="calculate-total-covid-19-deaths-in-period" class="section level2">
<h2>Calculate total COVID-19 deaths in period</h2>
<p>A figure referenced in the text of the report</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>uk_deaths_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">tot_deaths =</span> <span class="kw">sum</span>(covid_deaths))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["tot_deaths"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"54511"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="figure-3" class="section level2">
<h2>Figure 3</h2>
<p>Deaths per 100,000 by UK nation. Using same data as above.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>uk_deaths_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(week_number, deaths_<span class="dv">100000</span>, <span class="dt">colour =</span> country)) <span class="op">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw">scale_colour_wsj</span>() <span class="op">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>()) <span class="op">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Weekly deaths attributed to COVID-19 per 100,000&quot;</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;by UK nation&quot;</span>,</span>
<span id="cb9-10"><a href="#cb9-10"></a>       <span class="dt">x =</span> <span class="st">&quot;Week number&quot;</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb9-12"><a href="#cb9-12"></a>       <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb9-13"><a href="#cb9-13"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source:ONS Deaths registered in England and Wales, UK deaths</span><span class="ch">\n</span><span class="st">Code:https://github.com/davidhen/ltc_covid_uk&quot;</span>) -&gt;<span class="st"> </span>fig_<span class="dv">2</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>fig_<span class="dv">2</span></span></code></pre></div>
<p><img src="ltc_covid_uk_code_files/figure-html/unnamed-chunk-11-1.png" width="1152" /></p>
</div>
<div id="per-100000-values-by-nations" class="section level2">
<h2>per 100,000 values by nations</h2>
<p>Useful summary figures</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>uk_deaths_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">covid_deaths =</span> <span class="kw">sum</span>(covid_deaths),</span>
<span id="cb10-4"><a href="#cb10-4"></a>            <span class="dt">pop =</span> pop) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">  </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total_per_100k =</span> covid_deaths<span class="op">/</span>pop <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["covid_deaths"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["total_per_100k"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"England","2":"47111","3":"56286961","4":"84"},{"1":"Scotland","2":"4156","3":"5463300","4":"76"},{"1":"Wales","2":"2420","3":"3152879","4":"77"},{"1":"Northern Ireland","2":"824","3":"1893667","4":"44"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="uk-per-100k" class="section level2">
<h2>UK per 100k</h2>
<p>More useful summary figs</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>uk_deaths_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">covid_deaths =</span> <span class="kw">sum</span>(covid_deaths),</span>
<span id="cb11-4"><a href="#cb11-4"></a>            <span class="dt">pop =</span> pop) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">covid_deaths =</span> <span class="kw">sum</span>(covid_deaths),</span>
<span id="cb11-8"><a href="#cb11-8"></a>            <span class="dt">pop =</span> <span class="kw">sum</span>(pop)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">uk_death_100k =</span> covid_deaths<span class="op">/</span>pop <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["covid_deaths"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["uk_death_100k"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"54511","2":"66796807","3":"82"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>devtools<span class="op">::</span><span class="kw">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.2 (2020-06-22)
##  os       macOS Catalina 10.15.5      
##  system   x86_64, darwin17.0          
##  ui       X11                         
##  language (EN)                        
##  collate  en_GB.UTF-8                 
##  ctype    en_GB.UTF-8                 
##  tz       Europe/London               
##  date     2020-08-27                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  package     * version date       lib source        
##  assertthat    0.2.1   2019-03-21 [1] CRAN (R 4.0.0)
##  backports     1.1.8   2020-06-17 [1] CRAN (R 4.0.0)
##  blob          1.2.1   2020-01-20 [1] CRAN (R 4.0.0)
##  broom         0.7.0   2020-07-09 [1] CRAN (R 4.0.2)
##  callr         3.4.3   2020-03-28 [1] CRAN (R 4.0.0)
##  cellranger    1.1.0   2016-07-27 [1] CRAN (R 4.0.0)
##  cli           2.0.2   2020-02-28 [1] CRAN (R 4.0.0)
##  colorspace    1.4-1   2019-03-18 [1] CRAN (R 4.0.0)
##  crayon        1.3.4   2017-09-16 [1] CRAN (R 4.0.0)
##  crosstalk     1.1.0.1 2020-03-13 [1] CRAN (R 4.0.0)
##  curl        * 4.3     2019-12-02 [1] CRAN (R 4.0.0)
##  DBI           1.1.0   2019-12-15 [1] CRAN (R 4.0.0)
##  dbplyr        1.4.4   2020-05-27 [1] CRAN (R 4.0.0)
##  desc          1.2.0   2018-05-01 [1] CRAN (R 4.0.0)
##  devtools      2.3.1   2020-07-21 [1] CRAN (R 4.0.0)
##  digest        0.6.25  2020-02-23 [1] CRAN (R 4.0.0)
##  dplyr       * 1.0.1   2020-07-31 [1] CRAN (R 4.0.2)
##  DT            0.15    2020-08-05 [1] CRAN (R 4.0.2)
##  ellipsis      0.3.1   2020-05-15 [1] CRAN (R 4.0.0)
##  evaluate      0.14    2019-05-28 [1] CRAN (R 4.0.0)
##  fansi         0.4.1   2020-01-08 [1] CRAN (R 4.0.0)
##  farver        2.0.3   2020-01-16 [1] CRAN (R 4.0.0)
##  feather       0.3.5   2019-09-15 [1] CRAN (R 4.0.0)
##  forcats     * 0.5.0   2020-03-01 [1] CRAN (R 4.0.0)
##  fs            1.5.0   2020-07-31 [1] CRAN (R 4.0.2)
##  generics      0.0.2   2018-11-29 [1] CRAN (R 4.0.0)
##  ggplot2     * 3.3.2   2020-06-19 [1] CRAN (R 4.0.0)
##  ggthemes    * 4.2.0   2019-05-13 [1] CRAN (R 4.0.0)
##  glue          1.4.1   2020-05-13 [1] CRAN (R 4.0.0)
##  gtable        0.3.0   2019-03-25 [1] CRAN (R 4.0.0)
##  haven         2.3.1   2020-06-01 [1] CRAN (R 4.0.0)
##  here        * 0.1     2017-05-28 [1] CRAN (R 4.0.0)
##  hms           0.5.3   2020-01-08 [1] CRAN (R 4.0.0)
##  htmltools     0.5.0   2020-06-16 [1] CRAN (R 4.0.0)
##  htmlwidgets   1.5.1   2019-10-08 [1] CRAN (R 4.0.0)
##  httr          1.4.2   2020-07-20 [1] CRAN (R 4.0.0)
##  jsonlite      1.7.0   2020-06-25 [1] CRAN (R 4.0.0)
##  knitr         1.29    2020-06-23 [1] CRAN (R 4.0.2)
##  labeling      0.3     2014-08-23 [1] CRAN (R 4.0.0)
##  lifecycle     0.2.0   2020-03-06 [1] CRAN (R 4.0.0)
##  lubridate   * 1.7.9   2020-06-08 [1] CRAN (R 4.0.2)
##  magrittr      1.5     2014-11-22 [1] CRAN (R 4.0.0)
##  memoise       1.1.0   2017-04-21 [1] CRAN (R 4.0.0)
##  modelr        0.1.8   2020-05-19 [1] CRAN (R 4.0.0)
##  munsell       0.5.0   2018-06-12 [1] CRAN (R 4.0.0)
##  patchwork   * 1.0.1   2020-06-22 [1] CRAN (R 4.0.2)
##  pillar        1.4.6   2020-07-10 [1] CRAN (R 4.0.2)
##  pkgbuild      1.1.0   2020-07-13 [1] CRAN (R 4.0.2)
##  pkgconfig     2.0.3   2019-09-22 [1] CRAN (R 4.0.0)
##  pkgload       1.1.0   2020-05-29 [1] CRAN (R 4.0.0)
##  prettyunits   1.1.1   2020-01-24 [1] CRAN (R 4.0.0)
##  processx      3.4.3   2020-07-05 [1] CRAN (R 4.0.0)
##  ps            1.3.4   2020-08-11 [1] CRAN (R 4.0.2)
##  purrr       * 0.3.4   2020-04-17 [1] CRAN (R 4.0.0)
##  R6            2.4.1   2019-11-12 [1] CRAN (R 4.0.0)
##  Rcpp          1.0.5   2020-07-06 [1] CRAN (R 4.0.0)
##  readODS     * 1.7.0   2020-07-10 [1] CRAN (R 4.0.2)
##  readr       * 1.3.1   2018-12-21 [1] CRAN (R 4.0.0)
##  readxl      * 1.3.1   2019-03-13 [1] CRAN (R 4.0.0)
##  rematch       1.0.1   2016-04-21 [1] CRAN (R 4.0.0)
##  remotes       2.2.0   2020-07-21 [1] CRAN (R 4.0.0)
##  reprex        0.3.0   2019-05-16 [1] CRAN (R 4.0.0)
##  rlang         0.4.7   2020-07-09 [1] CRAN (R 4.0.0)
##  rmarkdown     2.3     2020-06-18 [1] CRAN (R 4.0.2)
##  rprojroot     1.3-2   2018-01-03 [1] CRAN (R 4.0.0)
##  rstudioapi    0.11    2020-02-07 [1] CRAN (R 4.0.0)
##  rvest         0.3.6   2020-07-25 [1] CRAN (R 4.0.2)
##  scales        1.1.1   2020-05-11 [1] CRAN (R 4.0.0)
##  sessioninfo   1.1.1   2018-11-05 [1] CRAN (R 4.0.0)
##  socviz      * 1.2     2020-06-10 [1] CRAN (R 4.0.2)
##  stringi       1.4.6   2020-02-17 [1] CRAN (R 4.0.0)
##  stringr     * 1.4.0   2019-02-10 [1] CRAN (R 4.0.0)
##  testthat      2.3.2   2020-03-02 [1] CRAN (R 4.0.0)
##  tibble      * 3.0.3   2020-07-10 [1] CRAN (R 4.0.2)
##  tidyr       * 1.1.1   2020-07-31 [1] CRAN (R 4.0.2)
##  tidyselect    1.1.0   2020-05-11 [1] CRAN (R 4.0.0)
##  tidyverse   * 1.3.0   2019-11-21 [1] CRAN (R 4.0.0)
##  usethis       1.6.1   2020-04-29 [1] CRAN (R 4.0.0)
##  utf8          1.1.4   2018-05-24 [1] CRAN (R 4.0.0)
##  vctrs         0.3.2   2020-07-15 [1] CRAN (R 4.0.0)
##  withr         2.2.0   2020-04-20 [1] CRAN (R 4.0.0)
##  xfun          0.16    2020-07-24 [1] CRAN (R 4.0.2)
##  xml2          1.3.2   2020-04-23 [1] CRAN (R 4.0.0)
##  yaml          2.2.1   2020-02-01 [1] CRAN (R 4.0.0)
## 
## [1] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
